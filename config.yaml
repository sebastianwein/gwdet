seed_everything: 42

trainer:
  max_epochs: 64
  logger:
  - class_path: CSVLogger
    init_args:
      save_dir: . 
      name: "logs"

  callbacks: 
    - class_path: callbacks.default.Summary
    - class_path: pytorch_lightning.callbacks.ModelSummary
      init_args: 
        max_depth: 3

    - class_path: callbacks.default.ConfusionMatrix
    - class_path: callbacks.default.ROC
    - class_path: callbacks.default.SNRAccuracy
      init_args:
        snr_range:
        - 5
        - 15
        bins: 10

    - class_path: callbacks.mha.AttentionHeatMap
    - class_path: callbacks.mha.PlotKernels
    - class_path: callbacks.mha.PositionalEncoding

model:
  class_path: models.mha.MHAModel
  init_args:
    token_length: 4096
    embed_dim: 128
    pos_enc: "static"
    num_heads: 16
    num_layers: 16
    ff_dim: 512
    dropout: 0.25
    learning_rate: 0.0005
    weight_decay: 0
    warmup: 2000

data:
  class_path: data.GGWDData
  init_args:
    data_dirs: 
      - "/scratch/tmp/swein/ggwd/output/long/data"
    length: 131072
    whiten: False
    segment_duration: 4
    max_filter_duration: 4
    batch_size: 64
    num_workers: 4